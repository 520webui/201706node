<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="node_modules/animate.css/animate.css">
</head>
<body>
<div id="app">
    <div class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand">管理系统</a>
            </div>
            <ul class="navbar-nav nav">
                <li><router-link to="/home">首页</router-link></li>
                <li><router-link to="/list">列表</router-link></li>
                <li><router-link to="/profile">个人中心</router-link></li>
                <li><router-link to="/login">登录</router-link></li>
            </ul>
        </div>
    </div>
    <div class="container">
        <!--<keep-alive> 内置的组件不让组件销毁，此时created方法中不会再次执行，相当于做了缓存-->
            <router-view></router-view>
    </div>
</div>
<template id="home"><div>首页</div></template>
<template id="list">
    <div>
        <ul class="list-group">
            <li class="list-group-item" v-for="list in lists">{{list.title}}</li>
        </ul>
    </div>
</template>
<template id="profile">
    <div class="row">
        <div class="nav nav-stacked col-md-3">
            <li><router-link to="/profile/about">关于我</router-link></li>
        </div>
        <router-view class="col-md-9"></router-view>
    </div>
</template>
<template id="login"><div>登录</div></template>
<script src="node_modules/axios/dist/axios.js"></script>
<script src="node_modules/vue/dist/vue.js"></script>
<script src="node_modules/vue-router/dist/vue-router.js"></script>
<script>
    //首页 列表页 个人信息页 登陆
    let Home = {template:'#home'};
    let List = {
        template:'#list',
        data(){
            return {lists:[]}
        },
        beforeRouteEnter(to,from,next){ //在路由进入之前
            //默认相当于可以向下执行，看你是否调用了next，没有调用next表示不继续
            //在这里可以获取数据 获取成功后渲染组件，好处不会有闪烁问题，但是在这之前路由不会发生改变 等待调用next才会进行改变
            axios.get('./list.json').then((res)=>{
                setTimeout(()=>{
                    //this.lists = res.data; //此时获取不到this
                    next(vm=>{
                        vm.lists = res.data;
                    });//next中可以传入回调函数，当created执行后会调用这个回调函数，并且将this传递进去
                },3000);
            });
        },
        created(){ //目前只能组件中获取数据,在组件中获取数据,缺陷就是先跳转了 后加载
            /*axios.get('./list.json').then((res)=>{
                setTimeout(()=>{
                    this.lists = res.data;
                },3000);
            });*/
        }
    };
    let Profile = {template:'#profile'};
    let Login = {template:'#login'};
    let AboutMe = {template:'<div>关于我</div>'}
    let router = new VueRouter({
        routes:[
            {path:'/home',component:Home},
            {path:'/list',component:List},
            {path:'/profile',component:Profile,
                children:[
                    {path:'about',component:AboutMe}
                ]
            },
            {path:'/login',component:Login},
        ]
    });
    let vm = new Vue({
        el:'#app',
        router
    });
</script>
</body>
</html>